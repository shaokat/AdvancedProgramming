https://github.com/haskell/cabal/blob/master/cabal-install/Distribution/Client/Utils/Json.hs